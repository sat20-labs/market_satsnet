(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{6632:function(e,t,s){Promise.resolve().then(s.bind(s,1218))},1218:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return X}});var a=s(7437),r=s(2265),l=s(5273),n=s(5355),i=s(2732);let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});c.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...r})});o.displayName="CardHeader",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})}).displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})}).displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter";var u=s(9355),x=s(549);let m=e=>{let{onChange:t}=e,s=(0,r.useRef)(!0),{assets:l}=(0,x.aX)(),n=(0,r.useMemo)(()=>[{label:"SAT20 Token",key:"ordx",value:l.ordx.reduce((e,t)=>e+t.amount,0)},{label:"Runes",key:"runes",value:l.runes.reduce((e,t)=>e+t.amount,0)}],[l]),[m,h]=(0,r.useState)(n[0].key);return(0,r.useEffect)(()=>{m&&!s.current&&(null==t||t(m)),s.current=!1},[m]),(0,a.jsx)("div",{className:"grid grid-cols-2 max-w-4xl md:grid-cols-4 gap-2 md:gap-4",children:n.map(e=>(0,a.jsxs)(c,{className:(0,i.cn)("w-full h-[90px] max-w-full cursor-pointer hover:bg-zinc-800/80",m===e.key?"bg-zinc-900/60 border border-purple-600/80":"bg-transparent border border-zinc-800"),onClick:()=>{"nft"!==e.key&&h(e.key)},children:[(0,a.jsx)(o,{className:"p-3 pb-0",children:(0,a.jsx)("span",{className:"text-sm sm:text-sm font-mono text-gray-400",children:e.label})}),(0,a.jsxs)(d,{className:"p-3 pt-1 leading-8",children:[(0,a.jsxs)("div",{className:"flex items-center text-base sm:text-md",children:[(0,a.jsx)(u.JO,{icon:"cryptocurrency-color:btc",className:"mr-1"}),(0,a.jsx)("span",{className:"font-extrabold text-zinc-200",children:e.value})]}),(0,a.jsxs)("div",{className:"flex text-xs sm:font-bold",children:[(0,a.jsx)("span",{className:"text-yellow-400 w-5",children:" \xa0$"}),(0,a.jsx)("span",{className:"text-gray-400 h-5"})]})]})]},e.key))})};var h=s(837),f=s(4728),g=e=>{let{assetInfo:t,open:s,onOpenChange:r}=e;return(0,a.jsx)(h.Vq,{open:s,onOpenChange:r,children:(0,a.jsxs)(h.cZ,{className:"sm:max-w-[425px] bg-zinc-900 border-zinc-800 text-zinc-200",children:[(0,a.jsx)(h.fK,{children:(0,a.jsxs)(h.$N,{className:"text-zinc-100",children:["Sell ",t.displayname||t.assetName]})}),(0,a.jsx)("div",{className:"pt-4",children:(0,a.jsx)(f.Z,{assetInfo:t,onSellSuccess:()=>{r(!1)}})})]})})},p=s(495),j=s(2697),v=s(9629),b=s(9139),N=s(964),y=s(3908),z=s(1272);let w=e=>{let{assets:t}=e,[s,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),c=e=>{let t={assetName:e.key};console.log("Selected Asset:",t),i(t),l(!0)};return(0,a.jsxs)("div",{children:[(0,a.jsxs)(j.b,{"aria-label":"Assets List Table",cellPadding:0,cellSpacing:0,className:"w-full bg-accent/50 rounded-lg shadow-md border-collapse",children:[(0,a.jsx)(v.J,{columns:[{key:"name",label:"Name"},{key:"balance",label:"Balance"},{key:"price",label:"Price"},{key:"action",label:"Action"}],children:e=>(0,a.jsx)(b.j,{align:"action"===e.key||"price"===e.key?"end":"start",className:"action"===e.key||"price"===e.key?"h-12 text-right bg-accent":"text-left bg-accent",children:e.label},e.key)}),(0,a.jsx)(N.y,{items:t,emptyContent:"No assets found.",children:e=>(0,a.jsxs)(y.g,{className:"hover:bg-accent/50 cursor-pointer border-b-1 border-zinc-700/50",children:[(0,a.jsx)(z.X,{children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("span",{className:"font-medium text-white",children:e.label})})}),(0,a.jsx)(z.X,{children:(0,a.jsx)("span",{className:"text-white",children:e.amount})}),(0,a.jsx)(z.X,{className:"text-right",children:(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"-"})}),(0,a.jsx)(z.X,{className:"text-right",children:(0,a.jsx)(p.z,{size:"sm",color:"secondary",variant:"outline",className:"text-sm",onClick:()=>c(e),children:"List"})})]},e.id)})]}),s&&n&&(0,a.jsx)(g,{assetInfo:n,open:s,onOpenChange:l})]})},k=()=>{let[e,t]=(0,r.useState)("ordx"),{assets:s}=(0,x.aX)();console.log("assets",s);let l=s[e];return(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(m,{onChange:s=>{console.log("onProtocolChange",s),s!==e&&t(s)}})}),!!e&&(null==l?void 0:l.length)&&(0,a.jsx)(w,{assets:l})]})};var _=s(1552),S=s(3769),C=s(89),P=s(7517),A=s(7776),V=s(1698),L=s(4842),T=s(4281);let $=e=>{let{address:t}=e,{t:s}=(0,C.$G)(),{chain:l,network:n}=(0,S.Ee)(),{address:i}=(0,L.$)(),[c,o]=(0,r.useState)([]),[d,u]=(0,r.useState)(!0),[x,m]=(0,r.useState)(null),[h,f]=(0,r.useState)(1),[g,j]=(0,r.useState)(20),[v,b]=(0,r.useState)(0);(0,r.useEffect)(()=>{(async()=>{u(!0),m(null);try{let e=await _.w.getOrders({address:i||t,offset:(h-1)*g,size:g});o(e.data.order_list||[]),b(e.data.total||0)}catch(e){m("Failed to fetch orders"),console.error(e)}finally{u(!1)}})()},[i,t,h]);let N=async e=>{if("1"===e.locker){A.Am.error("Cancel order failed, The order is locked, please wait unlock it first");return}try{let s=await _.w.cancelOrder({address:i||t,order_id:e.order_id});200===s.code?(A.Am.success("Cancel order successfully!"),o(t=>t.filter(t=>t.order_id!==e.order_id))):A.Am.error("Cancel order failed")}catch(e){A.Am.error("Cancel order failed"),console.error(e)}},y=(0,r.useMemo)(()=>0===v?1:Math.ceil(v/g),[v,g]);return d?(0,a.jsx)("div",{children:"Loading..."}):x?(0,a.jsx)("div",{children:x}):(0,a.jsxs)("div",{className:"px-0 py-4 bg-zinc-900/50 rounded-xl shadow-md",children:[(0,a.jsx)("div",{className:"px-0 sm:px-4 overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full table-auto border-collapse border-b-1 border-zinc-800 rounded-xl",children:[(0,a.jsx)("thead",{className:"bg-zinc-800 text-zinc-400",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"sticky bg-zinc-800 left-0 h-12 z-10 px-4 py-2 text-left",children:"Name"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Type"}),(0,a.jsx)("th",{className:"px-4 py-2 text-right",children:"Quantity"}),(0,a.jsx)("th",{className:"px-4 py-2 text-right",children:"Unit Price"}),(0,a.jsx)("th",{className:"px-4 py-2 text-right",children:"Total Price"}),(0,a.jsx)("th",{className:"px-4 py-2 text-right",children:"Time"}),(0,a.jsx)("th",{className:"px-4 py-2 text-center",children:"Action"})]})}),(0,a.jsx)("tbody",{children:d?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"text-center text-zinc-400 py-4",children:"Loading..."})}):0===c.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"text-center text-zinc-400 py-4",children:"No assets found"})}):c.map((e,t)=>{var r,l;return(0,a.jsxs)("tr",{className:"group text-zinc-400 border-b-1 bg-zinc-900 hover:bg-zinc-800/95 border-zinc-800",children:[(0,a.jsxs)("td",{className:"sticky left-0 z-10 px-4 py-2 ",children:[(0,a.jsx)("span",{className:"font-medium",children:e.assets.assets_name.Ticker||"N/A"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-zinc-900 group-hover:bg-zinc-800/95 z-[-1]"})]}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)("span",{className:"text-gray-400",children:e.assets.assets_name.Protocol||"N/A"})}),(0,a.jsx)("td",{className:"px-4 py-2 text-right",children:(0,a.jsx)("span",{children:(null===(r=e.assets.amount)||void 0===r?void 0:r.toLocaleString())||0})}),(0,a.jsxs)("td",{className:"px-4 py-2 text-right",children:[(0,a.jsx)("span",{className:"font-bold",children:e.assets.unit_price}),(0,a.jsx)("span",{className:"pl-1 text-zinc-400",children:"sats"})]}),(0,a.jsxs)("td",{className:"font-mono px-4 py-2 text-right",children:[(0,a.jsxs)("div",{className:"text-lg text-gray-400",children:[(0,a.jsx)("span",{className:"font-bold",children:(null===(l=e.price)||void 0===l?void 0:l.toLocaleString())||0}),(0,a.jsx)("span",{className:"pl-1 text-zinc-400",children:"sats"})]}),(0,a.jsxs)("div",{className:"text-zinc-400",children:["$",(0,a.jsx)(V.H,{btc:(null==e?void 0:e.price)/1e8})]})]}),(0,a.jsx)("td",{className:"px-4 py-2 text-right",children:(0,a.jsx)("span",{className:"text-gray-400",children:e.order_time?new Date(e.order_time).toLocaleString():"N/A"})}),(0,a.jsx)("td",{className:"px-4 py-2 text-center",children:(0,a.jsx)(P.j,{className:"w-full",children:(0,a.jsx)(p.z,{className:"text-tiny h-8",size:"lg",color:"default",variant:"outline",onClick:()=>N(e),children:s("buttons.remove_sale")})})})]},e.order_id||"mock-".concat(t))})})]})}),v>0&&(0,a.jsx)("div",{className:"my-2 px-1 sm:px-4",children:(0,a.jsx)(T.$,{currentPage:h,totalPages:y,onPageChange:f,pageSize:g,onPageSizeChange:e=>{j(e),f(1)},availablePageSizes:[10,20,50,100],isLoading:d})})]})};var E=s(7113),O=s(6294),R=s(5773);let q=[10,20,50,100],M=e=>{var t,s,l;let{assets_name:i,address:c}=e,{t:o}=(0,C.$G)(),{chain:d}=(0,S.Ee)(),[x,m]=(0,r.useState)(1),[h,f]=(0,r.useState)(20),[g,j]=(0,r.useState)(1),[v,b]=(0,r.useState)(0),N=(0,r.useMemo)(()=>{let e=[{label:o("common.filter_all"),value:0},{label:o("common.delist"),value:2},{label:o("common.invalid"),value:3},{label:o("common.list"),value:4},{label:o("common.history_sell"),value:10},{label:o("common.history_buy"),value:11}];return e.sort((e,t)=>e.value-t.value),e},[o]),y=(0,n.a)({queryKey:["history",i,x,h,g,v,d,"my",c],queryFn:()=>_.w.getHistory({offset:(x-1)*h,size:h,assets_name:i,sort:g,filter:0===v?void 0:v,address:c}),enabled:!!c,refetchInterval:1e4,refetchIntervalInBackground:!1,staleTime:1e4}),z=e=>e.map(e=>{try{let t=Number(e.assets.amount),s=Number(e.assets.unit_price);if(isNaN(t)||isNaN(s))return console.warn("Skipping order ".concat(e.order_id,": Invalid quantity or price")),null;let a=e.txid?e.txtime:e.order_time,r=(0,E.D)(new Date(a),{addSuffix:!0}),l=o("common.unknown"),n=e.result;1===e.result?e.address===c?n=1===e.order_type?10:11:e.txaddress===c&&(n=1===e.order_type?11:10):(void 0===e.result||null===e.result||0===e.result)&&(n=4);let i=N.find(e=>e.value===n);return l=i?i.label:"".concat(o("common.unknown")," (").concat(n,")"),{order_id:e.order_id,eventTypeLabel:l,quantity:t,price:s,totalValue:t*s,time:r,txid:e.txid||void 0,from:e.address,to:e.txaddress}}catch(t){return console.error("Error transforming order ".concat(e.order_id,":"),e,t),null}}).filter(e=>null!==e),w=(0,r.useMemo)(()=>{var e,t;return(null===(t=y.data)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.order_list)?z(y.data.data.order_list):[]},[y.data]),k=null!==(l=null===(s=y.data)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.total)&&void 0!==l?l:0,P=(0,r.useMemo)(()=>0===k?1:Math.ceil(k/h),[k,h]);return c?(0,a.jsxs)("div",{className:"bg-zinc-900/90 sm:p-6 rounded-lg text-zinc-200 w-full",children:[(0,a.jsxs)("div",{className:"flex flex-wrap sm:flex-nowrap gap-2 sm:gap-4 items-center justify-end mb-4",children:[(0,a.jsxs)(O.Ph,{value:String(v),onValueChange:e=>b(Number(e)),children:[(0,a.jsx)(O.i4,{className:"w-[150px] bg-zinc-800 border-zinc-700 text-gray-300 h-8 text-xs sm:text-sm",children:(0,a.jsx)(O.ki,{placeholder:o("common.filter_placeholder")})}),(0,a.jsx)(O.Bw,{className:"bg-zinc-800 border-zinc-700 text-gray-300",children:N.map(e=>(0,a.jsx)(O.Ql,{value:String(e.value),className:"text-xs sm:text-sm",children:e.label},e.value))})]}),(0,a.jsx)(p.z,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-white transition-colors h-8 w-8","aria-label":o("common.refresh"),onClick:()=>{y.refetch()},children:(0,a.jsx)(u.JO,{icon:"mdi:refresh",className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(R.T,{activities:w,isLoading:y.isLoading,error:y.error})}),k>0&&(0,a.jsx)(T.$,{currentPage:x,totalPages:P,onPageChange:m,pageSize:h,onPageSizeChange:e=>{f(e),m(1)},availablePageSizes:q,isLoading:y.isLoading})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 gap-4",children:[(0,a.jsx)("p",{className:"text-gray-400",children:o("common.connect_wallet_to_view")}),(0,a.jsx)(p.z,{variant:"outline",children:o("common.connect_wallet")})]})};var I=s(6463);function X(){let{t:e}=(0,C.$G)(),t=(0,I.useSearchParams)().get("source")||"utxo",{address:s,balance:i}=(0,L.$)(e=>e),{chain:c,network:o}=(0,S.Ee)(),[d,u]=(0,r.useState)(t),[x,m]=(0,r.useState)(0),{data:h,isLoading:f}=(0,n.a)({queryKey:["addressAssetsValue",s,c,o],queryFn:()=>_.w.getAddressAssetsValue(s),enabled:!!s,refetchOnWindowFocus:!1,refetchOnReconnect:!1});return(0,r.useEffect)(()=>{if(console.log(h),null==h?void 0:h.data){var e;m((null===(e=h.data)||void 0===e?void 0:e.total_value)||0)}},[h]),console.log("totalSatValue",x),(0,a.jsxs)(l.mQ,{value:d,defaultValue:t,onValueChange:e=>{u(e),history.replaceState(null,"","?source=".concat(e))},className:"py-2 w-full",children:[(0,a.jsxs)(l.dr,{children:[(0,a.jsx)(l.SP,{value:"utxo",children:e("buttons.my_assets")}),(0,a.jsx)(l.SP,{value:"history",children:e("common.tx_history")}),(0,a.jsx)(l.SP,{value:"order",children:e("common.my_listings")})]}),(0,a.jsx)(l.nU,{value:"utxo",children:(0,a.jsx)(k,{})}),(0,a.jsx)(l.nU,{value:"history",children:(0,a.jsx)(M,{address:s})}),(0,a.jsx)(l.nU,{value:"order",children:(0,a.jsx)($,{address:s})})]})}},837:function(e,t,s){"use strict";s.d(t,{$N:function(){return h},Vq:function(){return i},cN:function(){return m},cZ:function(){return u},fK:function(){return x},hg:function(){return c}});var a=s(7437);s(2265);var r=s(3304),l=s(4697),n=s(2732);function i(e){let{...t}=e;return(0,a.jsx)(r.fC,{"data-slot":"dialog",...t})}function c(e){let{...t}=e;return(0,a.jsx)(r.xz,{"data-slot":"dialog-trigger",...t})}function o(e){let{...t}=e;return(0,a.jsx)(r.h_,{"data-slot":"dialog-portal",...t})}function d(e){let{className:t,...s}=e;return(0,a.jsx)(r.aV,{"data-slot":"dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function u(e){let{className:t,children:s,...i}=e;return(0,a.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,a.jsx)(d,{}),(0,a.jsxs)(r.VY,{"data-slot":"dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...i,children:[s,(0,a.jsxs)(r.x8,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(l.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function x(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function m(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(r.Dx,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg leading-none font-semibold",t),...s})}},5273:function(e,t,s){"use strict";s.d(t,{SP:function(){return c},dr:function(){return i},mQ:function(){return n},nU:function(){return o}});var a=s(7437);s(2265);var r=s(2447),l=s(2732);function n(e){let{className:t,...s}=e;return(0,a.jsx)(r.fC,{"data-slot":"tabs",className:(0,l.cn)("flex flex-col gap-2",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)(r.aV,{"data-slot":"tabs-list",className:(0,l.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)(r.xz,{"data-slot":"tabs-trigger",className:(0,l.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)(r.VY,{"data-slot":"tabs-content",className:(0,l.cn)("flex-1 outline-none",t),...s})}}},function(e){e.O(0,[695,280,42,951,630,159,4,115,358,971,23,744],function(){return e(e.s=6632)}),_N_E=e.O()}]);